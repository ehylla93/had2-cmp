// tree guard #1

Block
{
    integer AIEvent;
    integer DeAlarmovan = 0;
    integer RND = 1;
    integer RND_wait = 1500;
    Frame Rebel;		FRm_FindFrame(Rebel, "rebel");

    SetAlarmType(1023, True);	
}

  HUMAN_Suspend(True);				
  goto TheEnd;						
  Whenever A (_PlayerInRange(100);)			
{							
  HUMAN_Suspend(False);				
}							

  HUMAN_SETAIMODE_Aggressive();
  HUMAN_SETMODE_Stand();
  HUMAN_SETMODE_Guard();
  HUMAN_WeaponOnArm(False);
  HUMAN_SetOptimized(1);
  HUMAN_SETSIGHTRANGE(30);
  HUMAN_SETHEARRANGE(35);


label loop:
  RND =   _RandomInt(3) + 1;
  RND_wait =   _RandomInt(10000) + 5000;
    If (RND == 1)   
      {
          HUMAN_Move("TreeG1_1");
      }
    If (RND == 2) 
       { 
          HUMAN_Move("TreeG1_2");
       }
    If (RND == 3)   
      {
          HUMAN_Move("TreeG1_3");
      }
  If (DeAlarmovan == 1) {Goto TheEnd;}
  delay(RND_wait);
goto loop;


OnAlarm()
{
  Block
     {
         HUMAN_SETSIGHTRANGE(40);
         HUMAN_SETHEARRANGE(45);
         AIEvent =_GetAlarmType(); 
         PrintfNumber("AIE Tree Guard 1: ", AIEvent);
         If ((AIEvent == 2) or (AIEvent == 256)) {SendSignal(Rebel, 17); }	// pomocne Albertovi uši
         HUMAN_SETSIGHTRANGE(45);
         HUMAN_SETHEARRANGE(60);
         HUMAN_SETMODE_Silence();
         HUMAN_SETAIMODE_Aggressive();
         EndScript();
     }
}

OnAlarmDone()
{
  HUMAN_SETSIGHTRANGE(36);
  HUMAN_SETHEARRANGE(42);
  HUMAN_WeaponOnArm(True);
  HUMAN_SETMODE_Silence();
  HUMAN_SETAIMODE_Aggressive();
  HUMAN_SetOptimized(1);
  HUMAN_SETMODE_Crouch();  
  HUMAN_SetAlarm(False);
  DeAlarmovan = 1;
  Goto loop;
}

Label TheEnd: